---
title: "4. 资源管理"
date: 2021-06-14T15:36:47+10:00
draft: false
weight: 40
---

![虚拟机设置](2.1.4-fig-1.png)

您需要了解 vSphere 用于管理共享资源的以下概念：

- 资源预留
- 资源限制
- 资源共享
- 使用权

资源预留代表一种保证。它会影响提供程序（例如 ESXi），因为这是进行预留的地方。但是，它在 CPU 和 RAM 上的工作方式不同。

#### CPU

如果 VM 不使用该资源，那么就 VM 而言，它不会发挥作用。它仅在 VM 实际使用它的期间强制执行。

#### RAM

如果尚未使用，则不会生效。这意味着 ESXi 主机不会为 VM 分配任何物理 RAM。但是，一旦 VM 请求内存并为其提供服务，就会保留物理 RAM。从那时起，即使虚拟机不再使用物理 RAM，ESXi 也会继续保留物理 RAM。从某种意义上说，尽管虚拟机闲置了好几天，页面还是被锁定了。消耗的测量指标包括这个以反映这种行为。即使它没有被使用，也没有其他虚拟机可以触及它。

---

不应使用限制，因为它对来宾操作系统不可见。结果是不可预测的，并且可能造成比减少 VM 配置更糟糕的性能问题。对于 CPU，它会影响 CPU Ready 计数器。对于 RAM，在 VMX 文件中，这是 `sched.mem.max`.

与静态配置的预留和共享不同，使用权是*动态*计算的。它考虑了限制、保留和份额。对于 Shares，它当然必须考虑在同一主机上运行的其他 VM 的 Shares。虚拟机不能使用超过 ESXi 授权的内容。

Reservation, Share 和 Limit 是相对静态的。除非手动更改，否则它们不会波动。因此，它们的行为更像是一种财产，而不是一种衡量指标。